{% include 'base.html' with profile="/aky/admin/profile" home="/aky/admin" %}
{% load static %}
<link rel="stylesheet" href="{% static 'autoriser.css' %}">

  <style>
    h3 {
      text-align: center;
      font-family: "Poppins";
      font-size: 22px;
      margin-bottom: 25px;
      font-weight: normal;
    }

    table {
      border-spacing: 0;
      width: 90%;
      border-collapse: collapse;
      border: 1px solid #ddd;
      border-left: none;
      border-right: none;
      margin: 0px auto;
    }

    th, td {
      text-align: left;
      padding: 16px;
    }

    td input {
      width: 20px;
      height: 20px;
    }

    td:first-of-type {
      padding-left: 35px;
    }

    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    input[type=submit] {
      margin-top: 30px;
      padding: 12px 45px;
      font-size: 17px;
      color: white;
      background-color: rgb(114, 90, 255);
      border-radius: 10px;
      border: none;
    }

    input[type=submit]:hover {
      cursor: pointer;
    }

    .show-auth-modal {
      opacity: 0.5;
      visibility: visible;
      z-index: 1;
      background: black;
    }
    .modal-container {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      border: 2px solid black;
    }
    .auth-modal {
      height: 150px;
      width: 400px;
      padding: 1.3rem;
      background-color: #ddd;
      border: 1px solid #ddd;
      border-radius: 15px;
    }
    .close-btn {
      position: relative;
      float: right;
      margin-right: 20px;
      width: 30px;
      margin-top: 50px;
      font-size: 15px;
      border: none;
      border-radius: 4px;
    }
    .close-btn:hover {
      cursor: pointer;
    }
    .overlay {
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.25);
      z-index: 1;
    }

    .hidden {
      display: none;
    }

  </style>
  <main>
    {% block content %}

    <h3>Liste des étudiants</h3>
    
    {% if is_redirected %}
    <div class="modal-container">
      <div class="auth-modal" id="auth-modal">
        <div>Votre modification a été bien enrégistrée</div>  
        <button class="close-btn" onclick="closeModal()">OK</button>  
      </div>
      <div class="overlay"></div>
    </div>
    {% endif %}
    <form action="./" method="POST" style="font-size: 17px;">
      {% csrf_token %}
        <table overflow-x:auto>
          <tr>
            <th>Autorisé(e)</th>
            <th>N° carte</th>
            <th>Nom</th>
            <th>Prénoms</th>
          </tr>
           {% for etudiant in etudiants %}
          <tr>
            <td>
              {% if etudiant.deposer %}
              <input type="checkbox" id="{{etudiant.nom}} {{etudiant.prenoms}}" name="user_id" value="{{etudiant.user_id}}" checked>
              {% else %}
              <input type="checkbox" id="{{etudiant.nom}} {{etudiant.prenoms}}" name="user_id" value="{{etudiant.user_id}}">
              {% endif %}
            </td>
            <td>{{ etudiant.no_carte }}</td>
            <td>{{ etudiant.nom }}</td>
            <td>{{ etudiant.prenoms }}</td>
          </tr>
           {% endfor %}
        </table>
     <!--
     
--> 
     
      <center>
        <input type="submit" value="Valider" id="valider">
      </center>
    </form>

    {% endblock %}
  </main>

  {% include 'footer.html' %}
  <script>
    const containerModal = document.querySelector(".modal-container");
    const modal = document.querySelector("#auth-modal");
    const overlay = document.querySelector(".overlay");
    const openModalBtn = document.querySelector("#valider");

    const closeModal = function () {
      modal.classList.add("hidden");
      overlay.classList.add("hidden");
      containerModal.classList.add("hidden")
      console.log(containerModal.classList)
    };

    overlay.addEventListener("click", closeModal);

    // close modal when the Esc key is pressed
    document.addEventListener("keydown", function (e) {
      if (e.key === "Escape" && !modal.classList.contains("hidden")) {
        closeModal();
      }
    });

    const openModal = function () {
      modal.classList.remove("hidden");
      overlay.classList.remove("hidden");
  
    };

  openModalBtn.addEventListener("click", openModal);
  </script>